<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Map Editor</title>
  <style>
    body{margin:0;height:100vh;display:flex;font-family:"Segoe UI",sans-serif;background:#0f0f0f;color:#eee}
    #editorArea{flex:1;display:flex;flex-direction:column;background:#1a1a1a}
    #canvas{flex:1;background:#222;border-right:1px solid #333}
    #jsonPanel{width:400px;background:#121212;border-left:1px solid #333;display:flex;flex-direction:column}
    #jsonPanel h3{margin:0;padding:12px;font-size:14px;background:#1f1f1f;border-bottom:1px solid #333}
    #editorOutput{flex:1;width:100%;border:none;resize:none;padding:12px;font-family:monospace;font-size:13px;background:#0f0f0f;color:#eee;overflow:auto;white-space:pre}
    #copyBtn{background:#3b82f6;border:none;color:#fff;padding:8px;cursor:pointer;font-size:13px}
    #copyBtn:hover{background:#2563eb}
  </style>
</head>
<body>
  <div id="editorArea">
    <canvas id="canvas"></canvas>
  </div>
  <div id="jsonPanel">
    <h3>JSON Output</h3>
    <textarea id="editorOutput" readonly></textarea>
    <button id="copyBtn">Copy JSON</button>
  </div>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const output = document.getElementById('editorOutput');
    const copyBtn = document.getElementById('copyBtn');

    // Example world data
    const world = { platforms: [
      { x: 0, y: 660, w: 1200, h: 40, rotation: 0, material: "normal" },
      { x: 150, y: 520, w: 250, h: 20, rotation: 0, material: "ice" }
    ]};

    // Pretty-print JSON
    output.value = JSON.stringify(world.platforms, null, 2);

    copyBtn.addEventListener('click', () => {
      output.select();
      document.execCommand('copy');
      alert('JSON copied to clipboard!');
    });

    // Resize canvas to fill left side
    function resizeCanvas() {
      canvas.width = window.innerWidth - document.getElementById('jsonPanel').offsetWidth;
      canvas.height = window.innerHeight;
      drawGrid();
    }
    window.addEventListener('resize', resizeCanvas);

    // Draw a simple grid so the editor area is visible
    function drawGrid() {
      ctx.fillStyle = '#222';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.strokeStyle = '#444';
      for (let x = 0; x < canvas.width; x += 40) {
        ctx.beginPath();
        ctx.moveTo(x, 0);
        ctx.lineTo(x, canvas.height);
        ctx.stroke();
      }
      for (let y = 0; y < canvas.height; y += 40) {
        ctx.beginPath();
        ctx.moveTo(0, y);
        ctx.lineTo(canvas.width, y);
        ctx.stroke();
      }
    }

    resizeCanvas();
  </script>
</body>
</html>
